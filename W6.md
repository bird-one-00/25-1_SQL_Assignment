# SQL 6ì£¼ì°¨ ì •ê·œê³¼ì œ

## ì¢…í•© ì‹¤ì „ ë¬¸ì œ í’€ì´

- ğŸ”— [ë³µìˆ˜ êµ­ì  ë©”ë‹¬ ìˆ˜ìƒí•œ ì„ ìˆ˜ ì°¾ê¸°](https://solvesql.com/problems/multiple-medalist/)

![](https://github.com/bird-one-00/25-1_SQL_Assignment/blob/main/img/%EC%8A%A4%ED%81%AC%EB%A6%B0%EC%83%B7%202025-05-19%20212334.png)

```
- ì¿¼ë¦¬ë¥¼ ì‘ì„±í•˜ëŠ” ëª©í‘œ, í™•ì¸í•  ì§€í‘œ: name
- ì¿¼ë¦¬ ê³„ì‚° ë°©ë²•: count í•¨ìˆ˜ ì‚¬ìš©
- ë°ì´í„°ì˜ ê¸°ê°„: 2000ë…„ ì´í›„
- ì‚¬ìš©í•  í…Œì´ë¸”: records, atheletes, games
- Join KEY:
  JOIN athletes AS a ON r.athlete_id = a.id
  JOIN games AS g ON r.game_id = g.id
- ë°ì´í„° íŠ¹ì§•: í•œ ì„ ìˆ˜ê°€ 2ê°œ ì´ìƒì˜ êµ­ì ìœ¼ë¡œ ë©”ë‹¬ì„ ìˆ˜ìƒí–ˆì—ˆìŒ
```

### ì‘ì„±í•œ SQL ì¿¼ë¦¬
```SQL
SELECT a.name
FROM records AS r
  JOIN athletes AS a ON r.athlete_id = a.id
  JOIN games AS g ON r.game_id = g.id
WHERE g.year >= 2000
  AND r.medal IS NOT NULL
GROUP BY r.athlete_id
HAVING COUNT(DISTINCT r.team_id) >= 2
ORDER BY a.name;
```

- ğŸ”— [ì˜¨ë¼ì¸ ì‡¼í•‘ëª°ì˜ ì›” ë³„ ë§¤ì¶œì•¡ ì§‘ê³„](https://solvesql.com/problems/shoppingmall-monthly-summary/)

![](https://github.com/bird-one-00/25-1_SQL_Assignment/blob/main/img/%EC%8A%A4%ED%81%AC%EB%A6%B0%EC%83%B7%202025-05-19%20213045.png)

```
- ì¿¼ë¦¬ë¥¼ ì‘ì„±í•˜ëŠ” ëª©í‘œ, í™•ì¸í•  ì§€í‘œ: order_month, ordered_amount, canceled_amount, total_amount
- ì¿¼ë¦¬ ê³„ì‚° ë°©ë²•: SUM
- ë°ì´í„°ì˜ ê¸°ê°„: X
- ì‚¬ìš©í•  í…Œì´ë¸”: orders, order_items
- Join KEY: JOIN order_items AS oi ON o.order_id = oi.order_id
- ë°ì´í„° íŠ¹ì§•: ì·¨ì†Œ ì£¼ë¬¸ ê¸ˆì•¡ì€ ìë™ìœ¼ë¡œ ìŒìˆ˜ë¡œ í‘œê¸°ë¨
```

### ì‘ì„±í•œ SQL ì¿¼ë¦¬
```SQL
SELECT
  STRFTIME('%Y-%m', o.order_date) AS order_month,
  SUM(CASE WHEN o.order_id NOT LIKE 'C%' THEN oi.price * oi.quantity ELSE 0 END) AS ordered_amount,
  SUM(CASE WHEN o.order_id LIKE 'C%' THEN oi.price * oi.quantity ELSE 0 END) AS canceled_amount,
  SUM(CASE WHEN o.order_id LIKE 'C%' THEN oi.price * oi.quantity ELSE oi.price * oi.quantity END) AS total_amount
--SUM(oi.price * oi.quantity) AS total_amount
FROM orders AS o
JOIN order_items AS oi ON o.order_id = oi.order_id
GROUP BY order_month
ORDER BY order_month;
```

- ğŸ”— [ì„¸ ëª…ì´ ì„œë¡œ ì¹œêµ¬ì¸ ê´€ê³„ ì°¾ê¸°](https://solvesql.com/problems/friend-group-of-3/)

![](https://github.com/bird-one-00/25-1_SQL_Assignment/blob/main/img/%EC%8A%A4%ED%81%AC%EB%A6%B0%EC%83%B7%202025-05-19%20214931.png)

```
- ì¿¼ë¦¬ë¥¼ ì‘ì„±í•˜ëŠ” ëª©í‘œ, í™•ì¸í•  ì§€í‘œ: IDê°€ 3820ì¸ ì‚¬ìš©ìë¥¼ í¬í•¨í•œ 3ëª…ì´ ì„œë¡œ ì¹œêµ¬ê´€ê³„ì¸ ê²½ìš° ì¶”ì¶œ
- ì¿¼ë¦¬ ê³„ì‚° ë°©ë²•: JOIN
- ë°ì´í„°ì˜ ê¸°ê°„: X
- ì‚¬ìš©í•  í…Œì´ë¸”: edges
- Join KEY:
    JOIN edges e2 ON e1.user_b_id = e2.user_a_id
    JOIN edges e3 ON e2.user_b_id = e3.user_b_id
- ë°ì´í„° íŠ¹ì§•: ì¤‘ë³µì´ ë‚˜ì˜¤ëŠ” ê²½ìš°ì˜ ìˆ˜ë¥¼ ì œê±°í•´ì•¼ í•¨
```

### ì‘ì„±í•œ SQL ì¿¼ë¦¬
```SQL
SELECT 
    e1.user_a_id AS user_a_id,
    e1.user_b_id AS user_b_id,
    e2.user_b_id AS user_c_id
FROM edges e1
JOIN edges e2 ON e1.user_b_id = e2.user_a_id
JOIN edges e3 ON e2.user_b_id = e3.user_b_id
  AND e1.user_a_id = e3.user_a_id
WHERE e1.user_a_id < e1.user_b_id
  AND e1.user_b_id < e2.user_b_id
  AND 3820 IN (e1.user_a_id, e1.user_b_id, e2.user_b_id);
```